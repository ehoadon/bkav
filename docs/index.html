<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Trang T·ªïng H·ª£p D·ª± √Ån & Admin Dashboard</title>
  <!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.6.0/firebase-database-compat.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --primary-color: #0066cc;
      --secondary-color: #005bb5;
      --bg-color: #f0f4f8;
      --card-bg: #fff;
      --text-color: #222;
      --shadow: rgba(0,0,0,0.1);
    }
    * { box-sizing:border-box; margin:0; padding:0; }
    body { font-family:Arial,sans-serif; background:var(--bg-color); color:var(--text-color); min-height:100vh; }
    header { background:var(--primary-color); color:#fff; padding:1.5rem 1rem; position:relative; text-align:center; }
    header h1 { font-size:1.8rem; margin-bottom:0.2rem; }
    header p  { opacity:0.85; font-size:1rem; }
    #userArea { position:absolute; top:1rem; right:1rem; }
    .container { max-width:1200px; margin:2rem auto; padding:0 1rem; }
    .grid { display:grid; gap:1.5rem; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); }
    .card { background:var(--card-bg); border-radius:8px; box-shadow:0 2px 6px var(--shadow); overflow:hidden; display:flex; flex-direction:column; transition:transform .2s; }
    .card:hover { transform:translateY(-4px); }
    .card img { width:100%; height:140px; object-fit:cover; }
    .card-content { padding:1rem; flex:1; display:flex; flex-direction:column; }
    .card-content h3 { margin-bottom:.75rem; color:var(--primary-color); font-size:1.1rem; }
    .card-content p { flex:1; font-size:.95rem; margin-bottom:1rem; }
    .card-content a { align-self:flex-start; text-decoration:none; background:var(--primary-color); color:#fff; padding:.5rem 1rem; border-radius:4px; transition:background .2s; }
    .card-content a:hover { background:var(--secondary-color); }
    footer { text-align:center; padding:1rem 0; background:#fff; border-top:1px solid #ddd; font-size:.9rem; color:#555; margin-top:2rem; }

    /* Login/Signup Overlay */
    #login-container {
      position:fixed; inset:0; background:rgba(0,0,0,0.5);
      justify-content:center; align-items:center; display:none; z-index:999;
    }
    .login-card {
      background:#fff; padding:1.5rem; border-radius:8px;
      box-shadow:0 2px 8px var(--shadow); width:320px; text-align:center;
    }
    .login-card h2 { color:var(--primary-color); margin-bottom:1rem; font-size:1.25rem; }
    .login-card input {
      width:100%; padding:.5rem; margin-bottom:.75rem;
      border:1px solid #ccc; border-radius:4px;
    }
    .login-card button {
      width:48%; padding:.5rem; background:var(--primary-color);
      color:#fff; border:none; border-radius:4px; cursor:pointer; transition:.2s;
    }
    .login-card button:hover { background:var(--secondary-color); }
    .login-card .error { color:red; font-size:.85rem; margin-top:.5rem; }

    /* Dashboard styles */
    #dashboard { display:none; padding:2rem 0; }
    .stats-grid {
      display:grid; gap:1rem;
      grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
      margin-bottom:2rem;
    }
    .stat-card {
      background:var(--card-bg); padding:1rem; border-radius:8px;
      box-shadow:0 1px 4px var(--shadow); text-align:center;
    }
    .stat-card h4 { font-size:1rem; color:var(--primary-color); margin-bottom:.5rem; }
    .stat-card p { font-size:1.6rem; font-weight:bold; }
    .chart-container {
      background:var(--card-bg); padding:1rem; border-radius:8px;
      box-shadow:0 1px 4px var(--shadow);
    }
    #btnLogout { background:var(--secondary-color); color:#fff; border:none; padding:.5rem 1rem; border-radius:4px; cursor:pointer; }
    #btnBack   { background:transparent; color:var(--secondary-color); border:1px solid var(--secondary-color); padding:.5rem 1rem; border-radius:4px; cursor:pointer; margin-right:1rem; }
  </style>
</head>
<body>

  <!-- Login / Signup Overlay -->
  <div id="login-container">
    <div class="login-card">
      <h2>ƒêƒÉng k√Ω / ƒêƒÉng nh·∫≠p</h2>
      <input  id="auth-email"    type="email"    placeholder="Email">
      <input  id="auth-password" type="password" placeholder="M·∫≠t kh·∫©u">
      <div style="display:flex; justify-content:space-between; gap:4%;">
        <button id="btnSignup">ƒêƒÉng k√Ω</button>
        <button id="btnLogin" >ƒêƒÉng nh·∫≠p</button>
      </div>
      <p id="authError" class="error"></p>
    </div>
  </div>

  <!-- Header & User Area -->
  <header>
    <h1>Trang T·ªïng H·ª£p D·ª± √Ån</h1>
    <p>N∆°i t·∫≠p trung c√°c c√¥ng c·ª• &amp; t√≠nh nƒÉng</p>
    <div id="userArea"></div>
  </header>

  <!-- Main Content -->
  <div id="main-content" class="container" style="display:none;">
    <nav class="grid">
      <!-- c√°c card c√¥ng c·ª• c≈© gi·ªØ nguy√™n -->
      <div class="card">
        <img src="images/encrypt-tool.png" alt="Encrypt Tool">
        <div class="card-content">
          <h3>C√¥ng C·ª• M√£ H√≥a/Gi·∫£i M√£</h3>
          <p>H·ªó tr·ª£ JSON, XML, BEPOS v·ªõi AES &amp; Base64</p>
          <a href="./En-Comp.V3.html">Chi ti·∫øt</a>
        </div>
      </div>
      <div class="card">
        <img src="images/ticks-converter.png" alt="Ticks Converter">
        <div class="card-content">
          <h3>C√¥ng C·ª• Chuy·ªÉn ƒë·ªïi Ticks</h3>
          <p>H·ªó tr·ª£ Chuy·ªÉn ƒë·ªïi Datetime sang Ticks</p>
          <a href="./datetimetoticks_V2.html">Chi ti·∫øt</a>
        </div>
      </div>
      <div class="card">
        <img src="images/xml-merge.png" alt="XML Merge">
        <div class="card-content">
          <h3>C√¥ng C·ª• G·ªôp File XML</h3>
          <p>H·ªó tr·ª£ g·ªôp nhi·ªÅu file XML th√†nh 1 file</p>
          <a href="./GopFileXML">Chi ti·∫øt</a>
        </div>
      </div>
      <div class="card">
        <img src="images/notes-manager.png" alt="Notes Manager">
        <div class="card-content">
          <h3>C√¥ng C·ª• Th·ªëng k√™ c√¥ng vi·ªác</h3>
          <p>H·ªó tr·ª£ Th·ªëng k√™ c√¥ng vi·ªác</p>
          <a href="./Note.html">Chi ti·∫øt</a>
        </div>
      </div>
      <div class="card">
        <img src="images/task-stats.png" alt="Task Stats">
        <div class="card-content">
          <h3>C√¥ng C·ª• Th·ªëng k√™ c√¥ng vi·ªác</h3>
          <p>H·ªó tr·ª£ Th·ªëng k√™ c√¥ng vi·ªác theo ng√†y-th√°ng</p>
          <a href="./TyLeXuLy.html">Chi ti·∫øt</a>
        </div>
      </div>
      <div class="card">
        <img src="images/invoice.png" alt="Invoice">
        <div class="card-content">
          <h3>C√¥ng C·ª• T·∫°o h√≥a ƒë∆°n</h3>
          <p>H·ªó tr·ª£ t·∫°o h√≥a ƒë∆°n v√† xu·∫•t ra file .xml</p>
          <a href="./CreateInvoice_UpdateV2">Chi ti·∫øt</a>
        </div>
      </div>
      <!-- ... c√°c card kh√°c ... -->
    </nav>
  </div>

  <!-- Admin Dashboard -->
  <div id="dashboard" class="container">
    <div style="text-align:right; margin-bottom:1rem;">
      <button id="btnBack">V·ªÅ trang ch√≠nh</button>
      <button id="btnLogout">ƒêƒÉng xu·∫•t</button>
    </div>
    <h2>Admin Dashboard</h2>
    <div class="stats-grid">
      <div class="stat-card"><h4>T·ªïng truy c·∫≠p</h4><p id="cntTotal">...</p></div>
      <div class="stat-card"><h4>Trang m√£ h√≥a</h4><p id="cntEncrypt">...</p></div>
      <div class="stat-card"><h4>Trang th·ªëng k√™</h4><p id="cntStats">...</p></div>
    </div>
    <div class="chart-container">
      <canvas id="pageChart" height="100"></canvas>
    </div>
  </div>

  <footer>&copy; 2025 ThangHDb. All rights reserved.</footer>

  <script>
    // 1) Firebase init
    const firebaseConfig = {
      apiKey: "AIzaSyDsdrQakeA8iZ3iVerSNRvXC9bneyzluSU",
      authDomain: "ehoadon‚Äëbkav.firebaseapp.com",
      databaseURL: "https://ehoadon‚Äëbkav-default-rtdb.firebaseio.com",
      projectId: "ehoadon‚Äëbkav",
      storageBucket: "ehoadon‚Äëbkav.appspot.com",
      messagingSenderId: "688737951508",
      appId: "1:688737951508:web:965514a6a1f7c4de15ac01",
      measurementId: "G‚ÄëVJFL3C86WM"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db   = firebase.database();

    // 2) UI refs
    const loginContainer = document.getElementById('login-container');
    const btnSignup      = document.getElementById('btnSignup');
    const btnLogin       = document.getElementById('btnLogin');
    const authError      = document.getElementById('authError');
    const userArea       = document.getElementById('userArea');
    const mainContent    = document.getElementById('main-content');
    const dashboard      = document.getElementById('dashboard');
    const btnLogout      = document.getElementById('btnLogout');
    const btnBack        = document.getElementById('btnBack');

    // 3) Show/hide according to auth
    function updateUI(user) {
      if (user) {
        loginContainer.style.display = 'none';
        userArea.innerHTML = `üëã Ch√†o m·ª´ng <strong>${user.email}</strong>`;
        mainContent.style.display = 'block';
        // admin only
        if (user.email === 'thanghdb@bkav.com') {
          dashboard.style.display = 'block';
          loadStats();
        } else {
          dashboard.style.display = 'none';
        }
      } else {
        loginContainer.style.display = 'flex';
        userArea.innerHTML = '';
        mainContent.style.display = 'none';
        dashboard.style.display = 'none';
      }
    }

    // 4) Auth listener
    auth.onAuthStateChanged(user => updateUI(user));
    // initial
    //updateUI(null);

    // 5) Sign‚Äëup
    btnSignup.onclick = () => {
      const email = document.getElementById('auth-email').value;
      const pass  = document.getElementById('auth-password').value;
      auth.createUserWithEmailAndPassword(email, pass)
        .catch(e => authError.textContent = e.message);
    };

    // 6) Login
    btnLogin.onclick = () => {
      const email = document.getElementById('auth-email').value;
      const pass  = document.getElementById('auth-password').value;
      auth.signInWithEmailAndPassword(email, pass)
        .catch(e => authError.textContent = e.message);
    };

    // 7) Logout & Back
    btnLogout.onclick = () => auth.signOut();
    btnBack.onclick   = () => mainContent.scrollIntoView();

    // 8) CountAPI + Chart.js
    async function fetchCount(key) {
      try {
        const r = await fetch(`https://api.countapi.xyz/get/demo/${key}`);
        return (await r.json()).value;
      } catch { return 0; }
    }
    async function loadStats() {
      const total = await fetchCount('index'),
            enc   = await fetchCount('encrypt'),
            stats = await fetchCount('stats');
      document.getElementById('cntTotal'  ).innerText = total;
      document.getElementById('cntEncrypt').innerText = enc;
      document.getElementById('cntStats'  ).innerText = stats;
      new Chart(document.getElementById('pageChart'), {
        type:'bar',
        data:{ labels:['Home','Encrypt','Stats'], datasets:[{ label:'Views', data:[total,enc,stats] }] },
        options:{ scales:{ y:{ beginAtZero:true } } }
      });
    }
    // init CountAPI keys
    ['index','encrypt','stats'].forEach(k=>
      fetch(`https://api.countapi.xyz/create?namespace=demo&key=${k}&value=0&enable=true`)
    );
  </script>
</body>
</html>
